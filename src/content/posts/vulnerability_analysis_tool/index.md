---
title: 취약점 탐지 자동화 도구 개발기
published: 2025-08-28
tags: [bugbounty]
description: " "
draft: true
---
### 들어가며
5월즈음 goldleo님과 함께 **버그줍줍단**이라는 버그바운티 팀을 만들게 되었습니다.
이번에 팀에서 NPM (Node Package Manager) 라이브러리들을 대상으로 취약점 발굴을 진행하는 프로젝트를 시작했고, 각자 자동화 도구의 프로토타입을 만들어 온 후 이들을 기반으로 함께 **Fuzzer**를 제작하기로 계획했습니다.

이미 서비스 되고 있는 도구들로는 Theori의 [Xint](https://xint.io/)나
Kakao의 [VulShot](https://tech.kakaobank.com/posts/2406-kabang-vulnerability-analysis-automation/) 등 여러 뛰어난 솔루션들이 있습니다.  
이번 글에서는 이러한 사레들을 참고하며 제가 구상한 자동화 도구의 요건과 제작 과정을 작성하고자 합니다.

---

### 설계하기
탐지 대상 취약점은 **ReDos/Dos**로 설정했습니다. 다른 취약점들에 비해 탐지하는데 어려움이 없기에 미숙한 제 설계 실력에 맞춤일거라 생각했습니다.

**ReDos**는 정규식 엔진의 backtracking 이슈로 인해 발생하는 DoS 개열의 취약점입니다. module 속 코드 덩어리에서 정규식을 추출하는 과정이 필요합니다.
분석과정은 다음과 같습니다
1. AST로 Regex 추출
2. Regex에 맞는 입력 생성
3. 실행 시간 측정
4. Logging

---

### AST 기반 Regex 탐지
Fuzzer 개발언어가 **TypeScript**이기에 먼저 그에 맞는 모듈을 탐색했습니다. 몇 가지를 테스팅 해본 결과 `acorn` 모듈을 선택했습니다.
먼저 Javascript에서 정규식이 어떻게 사용되는지와 acorn AST가 어떻게 파싱하는지 알아야했습니다.

Javascript 코드에서 정규식은 크게 아래 두 가지 방식으로 나타납니다

> **Literal (리터럴)**
```js
const regex = /^[0-9]+$/;
```
```json
{
  "type": "Literal",
  "start": 15,
  "end": 25,
  "value": {},
  "raw": "/^[0-9]+$/",
  "regex": {
    "pattern": "^[0-9]+$",
    "flags": ""
  }
}
```
AST 상에서 **Literal** 노드로 파싱되며, `regex.pattern`, `regex.flags` 속성을 가집니다

> **Expression (표현식)**
```js
const regex = new RegExp("/^[0-9]+$/", "i");
```
```json
{
  "type": "NewExpression",
  "start": 15,
  "end": 44,
  "callee": {
    "type": "Identifier",
    "start": 19,
    "end": 25,
    "name": "RegExp"
  },
  "arguments": [
    {
      "type": "Literal",
      "start": 26,
      "end": 38,
      "value": "/^[0-9]+$/",
      "raw": "\"/^[0-9]+$/\""
    },
    {
      "type": "Literal",
      "start": 40,
      "end": 43,
      "value": "i",
      "raw": "\"i\""
    }
  ]
}
```
AST 상에서 **NewExpression** 노드로 파싱되며, Literal과 다르게 `callee`와 `arguments[]` 값을 가집니다